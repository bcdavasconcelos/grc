# frozen_string_literal: true

require_relative 'grc/version'

# Methods for working with ancient greek in ruby
module Grc
  class Error < StandardError; end

  def grc?
    !scan(/(\p{Greek})/).empty?
  end

  def no_downcase_diacritics
    tr('á¼€á¼„á¾„á¼‚á¾‚á¼†á¾†á¾€á¼á¼…á¾…á¼ƒá¾ƒá¼‡á¾‡á¾Î¬Î¬á¾´á½°á¾²á¾°á¾¶á¾·á¾±á¾³á¼á¼”á¼’á¼‘á¼•á¼“Î­Î­á½²á¼ á¼¤á¾”á¼¢á¾’á¼¦á¾–á¾á¼¡á¼¥á¾•á¼£á¾“á¼§á¾—á¾‘Î®Î®á¿„á½´á¿‚á¿†á¿‡á¿ƒá¼°á¼´á¼²á¼¶á¼±á¼µá¼³á¼·Î¯Î¯á½¶á¿á¿–ÏŠÏŠÎá¿’á¿—á¿‘á½€á½„á½‚á½á½…á½ƒÏŒÏŒá½¸á¿¤á¿¥á½á½”á½’á½–á½‘á½•á½“á½—ÏÏá½ºá¿ á¿¦Ï‹Î°Î°Î°á¿¢á¿§á¿¡á½ á½¤á¾¤á½¢á¾¢á½¦á¾¦á¾ á½¡á½¥á¾¥á½£á¾£á½§á¾§á¾¡ÏŽÏŽá¿´á½¼á¿²á¿¶á¿·á¿³',
       'Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±Î±ÎµÎµÎµÎµÎµÎµÎµÎµÎµÎ·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î·Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¹Î¿Î¿Î¿Î¿Î¿Î¿Î¿Î¿Î¿ÏÏÏ…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï…Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰Ï‰')
  end

  def no_upcase_diacritics
    str = self
    ars = [[/[ÌÌ€Í‚ÌÌÌÌ€Í‚]/, ''], [/Î‘Í‚/, 'Î‘'], [/Î—Í‚/, 'Î—'], [/Î™Ì|Î™Ì€|Î™Í‚|ÌÎ™|Ì€Î™|Í‚Î™/, 'Î™'],
           [/Î¡Ì“/, 'Î¡'], [/ Î¥Ì€| ÌÎ¥|Î¥Ì“|Î¥Ì|Î¥Ì€|Î¥Í‚|ÌÎ¥|Ì€Î¥|Í‚Î¥/, 'Î¥'], [/Í‚Î©/, 'Î©']] # Adhoc solution for crazy diacritics with capital letters
    ars.each do |a|
      str = str.gsub(/#{a[0]}/, a[1])
    end
    str = str.tr('á¼ˆá¼Œá¼Šá¼Žá¼‰á¼á¼‹á¼Î†á¾ºá¾¸á¾¹á¼˜á¼œá¼šá¼™á¼á¼›Îˆá¿ˆá¼¨á¼¬á¼ªá¼®á¼©á¼­á¼«á¼¯Î‰á¿Šá¼¸á¼¼á¼ºá¼¾á¼¹á¼½á¼»á¼¿ÎŠá¿šá¿˜Îªá¿™á½ˆá½Œá½Šá½‰á½á½‹ÎŒá¿¸Î¡á¿¬á½™á½á½›á½ŸÎŽá¿ªá¿¨Î«á¿©á½¨á½¬á½ªá½®á½©á½­á½«á½¯Îá¿º',
                 'Î‘Î‘Î‘Î‘Î‘Î‘Î‘Î‘Î‘Î‘Î‘Î‘Î•Î•Î•Î•Î•Î•Î•Î•Î—Î—Î—Î—Î—Î—Î—Î—Î—Î—Î™Î™Î™Î™Î™Î™Î™Î™Î™Î™Î™Î™Î™ÎŸÎŸÎŸÎŸÎŸÎŸÎŸÎŸÎ¡Î¡Î¥Î¥Î¥Î¥Î¥Î¥Î¥Î¥Î¥Î©Î©Î©Î©Î©Î©Î©Î©Î©Î©')
  end

  def no_diacritics
    no_downcase_diacritics.no_upcase_diacritics
  end

  def tonos_to_oxia
    tr('Î†ÎˆÎ‰ÎŠÎŽÎŒÎÎ¬Î­Î®Î¯ÎÏÎ°ÏŒÏŽ',
       'Î†ÎˆÎ‰ÎŠÎŽÎŒÎÎ¬Î­Î®Î¯ÎÏÎ°ÏŒÏŽ')
  end

  def oxia_to_tonos
    tr('Î†ÎˆÎ‰ÎŠÎŽÎŒÎÎ¬Î­Î®Î¯ÎÏÎ°ÏŒÏŽ',
       'Î†ÎˆÎ‰ÎŠÎŽÎŒÎÎ¬Î­Î®Î¯ÎÏÎ°ÏŒÏŽ')
  end

  def acute_to_grave
    tr('á¼„á¾„á¼…á¾…Î¬Î¬á¾´á¼”á¼•Î­Î­á¼¤á¾”á¼¥á¾•Î®Î®á¿„á¼´á¼µÎ¯Î¯Îá½„á½…ÏŒÏŒá½”á½•ÏÏÎ°Î°á½¤á¾¤á½¥á¾¥ÏŽá¿´',
       'á¼‚á¾‚á¼ƒá¾ƒá½°á½°á¾²á¼’á¼“á½²á½²á¼¢á¾’á¼£á¾“á½´á½´á¿‚á¼²á¼³á½¶á½¶á¿’á½‚á½ƒá½¸á½¸á½’á½“á½ºá½ºá¿¢á¿¢á½¢á¾¢á½£á¾£á½¼á¿²')
  end

  def grave_to_acute
    tr('á¼‚á¾‚á¼ƒá¾ƒá½°á½°á¾²á¼’á¼“á½²á½²á¼¢á¾’á¼£á¾“á½´á½´á¿‚á¼²á¼³á½¶á½¶á¿’á½‚á½ƒá½¸á½¸á½’á½“á½ºá½ºá¿¢á¿¢á½¢á¾¢á½£á¾£á½¼á¿²',
       'á¼„á¾„á¼…á¾…Î¬Î¬á¾´á¼”á¼•Î­Î­á¼¤á¾”á¼¥á¾•Î®Î®á¿„á¼´á¼µÎ¯Î¯Îá½„á½…ÏŒÏŒá½”á½•ÏÏÎ°Î°á½¤á¾¤á½¥á¾¥ÏŽá¿´')
  end

  def tokenize
    gsub(/([[:punct:]]|Î‡|Â·|â€§|â¸±|ð„|\.|;|Í¾)/, ' \1').split
  end

  def unicode_char
    each_char.map(&:to_s)
  end

  def unicode_name
    require 'unicode/name'
    each_char.map { |character| Unicode::Name.of character }
  end

  def unicode_points
    unpack('U*').map { |i| "\\u#{i.to_s(16).rjust(4, "0").upcase}" }
  end

  def hash_dump
    hash = {}
    each_char do |character|
      hash[character] = character.dump
    end
    hash
  end

  def nfc
    unicode_normalize(:nfc)
  end

  def nfd
    unicode_normalize(:nfd)
  end
end

class String
  include Grc
end
